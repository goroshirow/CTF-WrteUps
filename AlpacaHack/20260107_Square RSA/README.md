# Square RSA

## / Overview

RSA暗号の $`n`$ が $`p^2`$ になっている。

## / Writeup

まず、$`n`$ の平方根を求めることで、$`p`$ を算出することができる。

ここでRSAと同じように

$$
d = e^{-1} \bmod \phi(n)
$$

として復号鍵 $`d`$ を求めたい。

**オイラーの定理**とは、ある自然数 $n$ に対して、$`\phi(n)=\#\{x \mid 1\le x\le n \text{ かつ } \gcd(x, n) = 1 \}`$ とすると、$`\gcd(a, n)=1`$ なる $`a`$ について

$$
a^{\phi(n)} \equiv 1 \pmod n
$$

となる関係のことである。

今回 $`n=p^2`$ なので、$`n`$ と互いに素でないものは $`p, 2p, \cdots , p \cdot p`$ の $`p`$ 個存在する。
したがって、

$$
\phi(n) = p^2 - p = p(p-1)
$$

となる。

よって $`d=e^{-1} \bmod p(p-1)`$ を用いて、$`m' = c^d \bmod n`$ をバイト変換したものがフラグになる。
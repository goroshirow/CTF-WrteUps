# one-p-rsa

## 概要

$`ct = m^e \pmod{p}`$ からmを復元する．

## 解法

有限体$`\mathbb{F}_p`$上では**フェルマーの小定理**が成り立つ．

$a^{p-1}\equiv 1 \pmod{p}$

つまり，mを復元するには$`e \cdot d = k(p-1) + 1`$となるようなdを探せば良い．これは$`e \cdot d \equiv 1 \pmod{p-1}`$と等価である．

このdを用いて

$ct^d \equiv m^{ed} \equiv m^{k(p-1) + 1} \equiv m \pmod{p}$

となる．

## 補足

実際のRSA暗号は素因数分解の困難性に基づいて設計されており，今回の解法が適用出来ない．

また$`a^{(p-1)(q-1)} \equiv 1 \pmod{pq}`$という性質を使っている．(中国剰余定理で証明可能)

### 鍵生成
1. 非常に大きい素数 p, q を選択して，n = pq とする．
2. 公開鍵 e を選択する．
   eと(p-1)(q-1)は互いに素ではなければならない．
3. $`d \equiv e^{-1} \pmod{(p-1)(q-1)}`$を計算する．
4. (e, n)を鍵として相手に送る．

### 暗号化
1. 暗号化したいメッセージ m に対して，$`c \equiv m^e \pmod{n}`$を計算して送り返す．

### 復号化
1. $`m' \equiv c^{d} \pmod{n}`$とすれば m' = m となってメッセージが復号できる．

ここで今回の手法を試そうとすると，(p-1)(q-1)を求める必要があるが，これを知るには p, q の値を知る必要があり，素因数分解の困難性から秘密鍵 d を求めることは出来ない．